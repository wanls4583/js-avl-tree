function AVLNode(t,e){this.key=t,this.data=e,this.lChild=null,this.rChild=null,this.pre=null,this.next=null,this.pNode=null,this.height=0}function AVLTree(t){this.root=null,this.compartor=t||function(){return 0}}var _proto=AVLTree.prototype;_proto.insert=function(t,e){var i=new AVLNode(t,e);if(this.root)return this._insert(this.root,i);this.root=i},_proto.delete=function(t){for(var e=[],i=this._delete(this.root,t);i;)e.push(i),i.pre&&(i.pre.next=i.next),i.next&&(i.next.pre=i.pre),i=this._delete(this.root,t);return 1==e.length?e[0]:!!e.length&&e},_proto.search=function(t){for(var e=[],i=this._search(this.root,t);i&&(e.push(i),i.next&&i.next.key==i.key);)i=i.next;return 1==e.length?e[0]:!!e.length&&e},_proto._insert=function(t,e){if(t.key==e.key&&0==this.compartor(t.data,e.data))return!1;if(t.key>e.key||t.key==e.key&&0<this.compartor(t.data,e.data))if(t.lChild){if(!this._insert(t.lChild,e))return!1;this._checkBalance(t)}else(t.lChild=e).pNode=t;else if(t.rChild){if(!this._insert(t.rChild,e))return!1;this._checkBalance(t)}else(t.rChild=e).pNode=t;return!e.next&&(t.key>e.key||t.key==e.key&&0<this.compartor(t.data,e.data))?(e.next=t).pre=e:!e.pre&&(t.key<e.key||t.key==e.key&&this.compartor(t.data,e.data)<0)&&((e.pre=t).next=e),this._setHeight(t),!0},_proto._delete=function(t,e){if(!t)return!1;if(t.key!=e)return t.key>e?!!(l=this._delete(t.lChild,e))&&(this._checkBalance(t),l):!!(l=this._delete(t.rChild,e))&&(this._checkBalance(t),l);if(t.lChild||t.rChild){if(t.lChild&&t.rChild){if(this._getHeight(t.lChild)>this._getHeight(t.rChild)){for(var i=t.lChild.rChild,h=t.lChild;i&&i.rChild;)i=i.rChild;i||(i=h),this._change(t,i);var l=this._delete(t.lChild,e);return this._setHeight(i),l}for(h=t.rChild.lChild,i=t.rChild;h&&h.lChild;)h=h.lChild;h||(h=i),this._change(t,h);var l=this._delete(i,e);return this._setHeight(t),l}var r=t.lChild||t.rChild;return this.root==t?(this.root=r,this.root.pNode=null):(t.pNode.lChild==t?t.pNode.lChild=r:t.pNode.rChild=r,r.pNode=t.pNode,this._setHeight(t.pNode)),t}return this.root==t?this.root=null:(t.pNode.lChild==t?t.pNode.lChild=null:t.pNode.rChild=null,this._setHeight(t.pNode)),t},_proto._search=function(t,e){return!!t&&(t.key==e?t:t.key>e?this._search(t.lChild,e):this._search(t.rChild,e))},_proto._lRotate=function(t){var e=t.rChild;e.pNode=t.pNode,t.rChild=e.lChild,e.lChild&&(e.lChild.pNode=t),(e.lChild=t)==this.root?this.root=e:t.pNode&&(t.pNode.lChild==t?t.pNode.lChild=e:t.pNode.rChild=e),t.pNode=e},_proto._rRotate=function(t){var e=t.lChild;e.pNode=t.pNode,t.lChild=e.rChild,e.rChild&&(e.rChild.pNode=t),(e.rChild=t)==this.root?this.root=e:t.pNode&&(t.pNode.lChild==t?t.pNode.lChild=e:t.pNode.rChild=e),t.pNode=e},_proto._lrRotate=function(t){return this._lRotate(t.lChild),this._rRotate(t)},_proto._rlRotate=function(t){return this._rRotate(t.rChild),this._lRotate(t)},_proto._change=function(t,e){var i=t.key,h=t.data;t.key=e.key,t.data=e.data,e.key=i,e.data=h},_proto._checkBalance=function(t){if(t.rChild&&this._getHeight(t.rChild)-this._getHeight(t.lChild)==2){var e=t.rChild;this._getHeight(t.rChild.rChild)>this._getHeight(t.rChild.lChild)?this._lRotate(t):this._rlRotate(t),this._setHeight(t),this._setHeight(e)}else if(t.lChild&&this._getHeight(t.lChild)-this._getHeight(t.rChild)==2){var i=t.lChild;this._getHeight(t.lChild.lChild)>this._getHeight(t.lChild.rChild)?this._rRotate(t):this._lrRotate(t),this._setHeight(t),this._setHeight(i)}},_proto._getHeight=function(t){return t?t.height:0},_proto._setHeight=function(t){var e=Math.max(this._getHeight(t.lChild),this._getHeight(t.rChild))+1;t.lChild||t.rChild||(e=0),t.height=e};