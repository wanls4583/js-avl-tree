<html>

<head>
    <meta charset="UTF-8"></meta>
    <script type="text/javascript" src="../avl_tree.js"></script>
</head>

<body>
    <script type="text/javascript">
    var tree = new AVLTree();
    var size = 10000;
    for (var i = 1; i <= size; i++) {
        tree.insert(i, 'data_' + i);
    }

    function testInsert() {
        console.log('%ctestInsert', 'color:red');
        var tree = new AVLTree();
        var size = 10000;
        for (var i = 1; i <= size; i++) {
            tree.insert(i, 'data_' + i);
        }
        console.log(tree.root);
        console.log('----------------------------------------');
    }

    function testDelete() {
        console.log('%ctestDelete', 'color:red');
        var tree = new AVLTree();
        var size = 10000;
        for (var i = 1; i <= size; i++) {
            tree.insert(i, 'data_' + i);
        }
        var retains = [];
        //只保留4个随机数目
        for (var i = 0; i < 4; i++) {
            retains.push((Math.random() * size) >> 0);
        }
        console.log('retains', retains);
        for (var i = 1; i <= size; i++) {
            if (retains.indexOf(i) == -1) {
                tree.delete(i);
            }
        }
        console.log(tree.root);
        console.log('----------------------------------------');
    }

    function testSeach() {
        console.log('%ctestSeach', 'color:red');
        var tree = new AVLTree();
        var size = 10000;
        for (var i = 1; i <= size; i++) {
            tree.insert(i, 'data_' + i);
        }
        for (var i = 0; i < 4; i++) {
            var tmp = (Math.random() * size) >> 0;
            console.log('key', tmp, tree.search(tmp));
        }
        console.log('----------------------------------------');
    }

    function testPreNext() {
        console.log('%ctestPreNext', 'color:red');
        var tree = new AVLTree();
        var size = 10000;
        for (var i = 1; i <= size; i++) {
            tree.insert(i, 'data_' + i);
        }
        var tmp = (Math.random() * size) >> 0;
        var first = tree.search(tmp);
        last = first;
        tmp = [];

        console.log('next');
        for (var i = 0; first && i < 5; i++) {
            tmp.push(first.key);
            first = first.next;
        }
        console.log(tmp);

        console.log('pre');
        tmp = [];
        for (var i = 0; last && i < 5; i++) {
            tmp.push(last.key);
            last = last.pre;
        }
        console.log(tmp);

        var tmp = (Math.random() * size) >> 0;
        console.log('after delete', tmp);
        tree.delete(tmp);
        var node = tree.search(tmp + 1);
        tmp = [];
        tmp.push(node.pre && node.pre.pre && node.pre.pre.key);
        tmp.push(node.pre && node.pre.key);
        tmp.push(node.key);
        tmp.push(node.next && node.next.key);
        tmp.push(node.next && node.next.next && node.next.next.key);
        console.log(tmp);
        console.log('----------------------------------------');
    }
    
    testInsert();
    testDelete();
    testSeach();
    testPreNext();
    </script>
</body>

</html>